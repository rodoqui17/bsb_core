"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _banitoken = require("../contracts/banitoken");

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

const Tx = require('ethereumjs-tx').Transaction;

const Web3 = require("web3");

//const web3 = new Web3(process.env.PROVIDERETH)
//const web3 = new Web3(process.env.PROVIDERLACCHAIN)
//const account = process.env.ACCOUNT;
//var privateKey = process.env.PVKEY;
// variables LOCALES GANACHE
const web3 = new Web3("HTTP://127.0.0.1:7545");
const account = "0xDef2aD70e887009c3F0E461Da576007ff267a09e";
const privateKey = "ae843743066014b37db9d9facde93d2eba6debbddb5ae4abe1a8fcab13b73ca1";
const storageContract = new web3.eth.Contract(_banitoken.ABI, _banitoken.contract_address);

class BlockchainServicies {
  constructor() {
    _defineProperty(this, "createuserbani", async (id, nombre, role, address) => {
      console.log(id, nombre, role, address);
      const networkId = await web3.eth.net.getId();
      const tx = storageContract.methods.creaUser(id, nombre, role, address);
      const gas = await tx.estimateGas({
        from: account
      });
      const gasPrice = await web3.eth.getGasPrice();
      const data = tx.encodeABI();
      const nonce = await web3.eth.getTransactionCount(account);
      const signedTx = await web3.eth.accounts.signTransaction({
        to: _banitoken.contract_address,
        data,
        gas: 300000,
        gasPrice,
        nonce,
        chainId: networkId
      }, privateKey);
      const receipt = await web3.eth.sendSignedTransaction(signedTx.rawTransaction);
      console.log(receipt.transactionHash);
      return receipt.transactionHash;
    });

    _defineProperty(this, "storeData", async (data_store, cuenta, llave) => {
      console.log(data_store);
      const networkId = await web3.eth.net.getId();
      const tx = storageContract.methods.store(data_store);
      const gas = await tx.estimateGas({
        from: cuenta
      });
      const gasPrice = await web3.eth.getGasPrice();
      const data = tx.encodeABI();
      const nonce = await web3.eth.getTransactionCount(cuenta);
      const signedTx = await web3.eth.accounts.signTransaction({
        to: _banitoken.contract_address,
        data,
        gas: 300000,
        gasPrice,
        nonce,
        chainId: networkId
      }, llave);
      const receipt = await web3.eth.sendSignedTransaction(signedTx.rawTransaction);
      console.log(receipt.transactionHash);
      storageContract.methods.retrieve().call().then(console.log);
      return receipt.transactionHash;
    });
  }

  getData() {
    return storageContract.methods.retrieve().call();
  }

  async getBlockNumber() {
    const response = web3.eth.getBlockNumber(function (error, result) {
      console.log(result);
      return result;
    });
    return Promise.resolve(response);
  }

  create_account(id) {
    const new_account = web3.eth.accounts.create();
    return Promise.resolve(new_account);
  }

  balance(address) {
    console.log(address);
    const add = web3.eth.getBalance(address);
    return Promise.resolve(add);
  }

  getTransaction(transaction) {
    const tx = web3.eth.getTransaction(transaction);
    return Promise.resolve(tx);
  }

}

var _default = new BlockchainServicies();

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci9hcGkvc2VydmljZXMvYmxvY2tjaGFpbi5zZXJ2aWNlcy5qcyJdLCJuYW1lcyI6WyJUeCIsInJlcXVpcmUiLCJUcmFuc2FjdGlvbiIsIldlYjMiLCJ3ZWIzIiwiYWNjb3VudCIsInByaXZhdGVLZXkiLCJzdG9yYWdlQ29udHJhY3QiLCJldGgiLCJDb250cmFjdCIsIkFCSSIsImNvbnRyYWN0X2FkZHJlc3MiLCJCbG9ja2NoYWluU2VydmljaWVzIiwiaWQiLCJub21icmUiLCJyb2xlIiwiYWRkcmVzcyIsImNvbnNvbGUiLCJsb2ciLCJuZXR3b3JrSWQiLCJuZXQiLCJnZXRJZCIsInR4IiwibWV0aG9kcyIsImNyZWFVc2VyIiwiZ2FzIiwiZXN0aW1hdGVHYXMiLCJmcm9tIiwiZ2FzUHJpY2UiLCJnZXRHYXNQcmljZSIsImRhdGEiLCJlbmNvZGVBQkkiLCJub25jZSIsImdldFRyYW5zYWN0aW9uQ291bnQiLCJzaWduZWRUeCIsImFjY291bnRzIiwic2lnblRyYW5zYWN0aW9uIiwidG8iLCJjaGFpbklkIiwicmVjZWlwdCIsInNlbmRTaWduZWRUcmFuc2FjdGlvbiIsInJhd1RyYW5zYWN0aW9uIiwidHJhbnNhY3Rpb25IYXNoIiwiZGF0YV9zdG9yZSIsImN1ZW50YSIsImxsYXZlIiwic3RvcmUiLCJyZXRyaWV2ZSIsImNhbGwiLCJ0aGVuIiwiZ2V0RGF0YSIsImdldEJsb2NrTnVtYmVyIiwicmVzcG9uc2UiLCJlcnJvciIsInJlc3VsdCIsIlByb21pc2UiLCJyZXNvbHZlIiwiY3JlYXRlX2FjY291bnQiLCJuZXdfYWNjb3VudCIsImNyZWF0ZSIsImJhbGFuY2UiLCJhZGQiLCJnZXRCYWxhbmNlIiwiZ2V0VHJhbnNhY3Rpb24iLCJ0cmFuc2FjdGlvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUVBOzs7O0FBRkEsTUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsZUFBRCxDQUFQLENBQXlCQyxXQUFwQzs7QUFDQSxNQUFNQyxJQUFJLEdB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R3RELElBQUksQ0FBQ0ksR0FBTCxDQUFTMkIsUUFBVCxDQUFrQndCLE1BQWxCLEVBQXBCO0FBQ0EsV0FBT0osT0FBTyxDQUFDQyxPQUFSLENBQWdCRSxXQUFoQixDQUFQO0FBQ0Q7O0FBRURFLEVBQUFBLE9BQU8sQ0FBQzVDLE9BQUQsRUFBVTtBQUNmQyxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUYsT0FBWjtBQUNBLFVBQU02QyxHQUFHLEdBQUd6RCxJQUFJLENBQUNJLEdBQUwsQ0FBU3NELFVBQVQsQ0FBb0I5QyxPQUFwQixDQUFaO0FBQ0EsV0FBT3VDLE9BQU8sQ0FBQ0MsT0FBUixDQUFnQkssR0FBaEIsQ0FBUDtBQUNEOztBQUVERSxFQUFBQSxjQUFjLENBQUNDLFdBQUQsRUFBYztBQUMxQixVQUFNMUMsRUFBRSxHQUFHbEIsSUFBSSxDQUFDSSxHQUFMLENBQVN1RCxjQUFULENBQXdCQyxXQUF4QixDQUFYO0FBQ0EsV0FBT1QsT0FBTyxDQUFDQyxPQUFSLENBQWdCbEMsRUFBaEIsQ0FBUDtBQUNEOztBQWpGdUI7O2VBc0ZYLElBQUlWLG1CQUFKLEUiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBUeCA9IHJlcXVpcmUoJ2V0aGVyZXVtanMtdHgnKS5UcmFuc2FjdGlvblxyXG5jb25zdCBXZWIzID0gcmVxdWlyZShcIndlYjNcIik7XHJcbmltcG9ydCB7IGNvbnRyYWN0X2FkZHJlc3MsIEFCSSB9IGZyb20gJy4uL2NvbnRyYWN0cy9iYW5pdG9rZW4nO1xyXG5cclxuLy9jb25zdCB3ZWIzID0gbmV3IFdlYjMocHJvY2Vzcy5lbnYuUFJPVklERVJFVEgpXHJcbi8vY29uc3Qgd2ViMyA9IG5ldyBXZWIzKHByb2Nlc3MuZW52LlBST1ZJREVSTEFDQ0hBSU4pXHJcbi8vY29uc3QgYWNjb3VudCA9IHByb2Nlc3MuZW52LkFDQ09VTlQ7XHJcbi8vdmFyIHByaXZhdGVLZXkgPSBwcm9jZXNzLmVudi5QVktFWTtcclxuXHJcblxyXG5cclxuLy8gdmFyaWFibGVzIExPQ0FMRVMgR0FOQUNIRVxyXG5jb25zdCB3ZWIzID0gbmV3IFdlYjMoXCJIVFRQOi8vMTI3LjAuMC4xOjc1NDVcIik7XHJcbmNvbnN0IGFjY291bnQgPSAoXCIweERlZjJhRDcwZTg4NzAwOWMzRjBFNDYxRGE1NzYwMDdmZjI2N2EwOWVcIik7XHJcbmNvbnN0IHByaXZhdGVLZXkgPSAoXCJhZTg0Mzc0MzA2NjAxNGIzN2RiOWQ5ZmFjZGU5M2QyZWJhNmRlYmJkZGI1YWU0YWJlMWE4ZmNhYjEzYjczY2ExXCIpO1xyXG5jb25zdCBzdG9yYWdlQ29udHJhY3QgPSBuZXcgd2ViMy5ldGguQ29udHJhY3QoQUJJLCBjb250cmFjdF9hZGRyZXNzKTtcclxuXHJcbmNsYXNzIEJsb2NrY2hhaW5TZXJ2aWNpZXMge1xyXG5cclxuICBjcmVhdGV1c2VyYmFuaSA9IGFzeW5jIChpZCwgbm9tYnJlLCByb2xlLCBhZGRyZXNzKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhpZCwgbm9tYnJlLCByb2xlLCBhZGRyZXNzKTtcclxuICAgIGNvbnN0IG5ldHdvcmtJZCA9IGF3YWl0IHdlYjMuZXRoLm5ldC5nZXRJZCgpO1xyXG4gICAgY29uc3QgdHggPSBzdG9yYWdlQ29udHJhY3QubWV0aG9kcy5jcmVhVXNlcihpZCwgbm9tYnJlLCByb2xlLCBhZGRyZXNzKTtcclxuICAgIGNvbnN0IGdhcyA9IGF3YWl0IHR4LmVzdGltYXRlR2FzKHsgZnJvbTogYWNjb3VudCB9KTtcclxuICAgIGNvbnN0IGdhc1ByaWNlID0gYXdhaXQgd2ViMy5ldGguZ2V0R2FzUHJpY2UoKTtcclxuICAgIGNvbnN0IGRhdGEgPSB0eC5lbmNvZGVBQkkoKTtcclxuICAgIGNvbnN0IG5vbmNlID0gYXdhaXQgd2ViMy5ldGguZ2V0VHJhbnNhY3Rpb25Db3VudChhY2NvdW50KTtcclxuICAgIGNvbnN0IHNpZ25lZFR4ID0gYXdhaXQgd2ViMy5ldGguYWNjb3VudHMuc2lnblRyYW5zYWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgdG86IGNvbnRyYWN0X2FkZHJlc3MsXHJcbiAgICAgICAgZGF0YSxcclxuICAgICAgICBnYXM6IDMwMDAwMCxcclxuICAgICAgICBnYXNQcmljZSxcclxuICAgICAgICBub25jZSxcclxuICAgICAgICBjaGFpbklkOiBuZXR3b3JrSWRcclxuICAgICAgfSxcclxuICAgICAgcHJpdmF0ZUtleVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHJlY2VpcHQgPSBhd2FpdCB3ZWIzLmV0aC5zZW5kU2lnbmVkVHJhbnNhY3Rpb24oc2lnbmVkVHgucmF3VHJhbnNhY3Rpb24pO1xyXG4gICAgY29uc29sZS5sb2cocmVjZWlwdC50cmFuc2FjdGlvbkhhc2gpO1xyXG4gICAgcmV0dXJuIHJlY2VpcHQudHJhbnNhY3Rpb25IYXNoO1xyXG4gIH1cclxuXHJcbiAgc3RvcmVEYXRhID0gYXN5bmMgKGRhdGFfc3RvcmUsIGN1ZW50YSwgbGxhdmUpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGRhdGFfc3RvcmUpO1xyXG4gICAgY29uc3QgbmV0d29ya0lkID0gYXdhaXQgd2ViMy5ldGgubmV0LmdldElkKCk7XHJcbiAgICBjb25zdCB0eCA9IHN0b3JhZ2VDb250cmFjdC5tZXRob2RzLnN0b3JlKGRhdGFfc3RvcmUpO1xyXG4gICAgY29uc3QgZ2FzID0gYXdhaXQgdHguZXN0aW1hdGVHYXMoeyBmcm9tOiBjdWVudGEgfSk7XHJcbiAgICBjb25zdCBnYXNQcmljZSA9IGF3YWl0IHdlYjMuZXRoLmdldEdhc1ByaWNlKCk7XHJcbiAgICBjb25zdCBkYXRhID0gdHguZW5jb2RlQUJJKCk7XHJcbiAgICBjb25zdCBub25jZSA9IGF3YWl0IHdlYjMuZXRoLmdldFRyYW5zYWN0aW9uQ291bnQoY3VlbnRhKTtcclxuICAgIGNvbnN0IHNpZ25lZFR4ID0gYXdhaXQgd2ViMy5ldGguYWNjb3VudHMuc2lnblRyYW5zYWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgdG86IGNvbnRyYWN0X2FkZHJlc3MsXHJcbiAgICAgICAgZGF0YSxcclxuICAgICAgICBnYXM6IDMwMDAwMCxcclxuICAgICAgICBnYXNQcmljZSxcclxuICAgICAgICBub25jZSxcclxuICAgICAgICBjaGFpbklkOiBuZXR3b3JrSWRcclxuICAgICAgfSxcclxuICAgICAgbGxhdmVcclxuICAgICk7XHJcbiAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgd2ViMy5ldGguc2VuZFNpZ25lZFRyYW5zYWN0aW9uKHNpZ25lZFR4LnJhd1RyYW5zYWN0aW9uKTtcclxuICAgIGNvbnNvbGUubG9nKHJlY2VpcHQudHJhbnNhY3Rpb25IYXNoKTtcclxuICAgIHN0b3JhZ2VDb250cmFjdC5tZXRob2RzLnJldHJpZXZlKCkuY2FsbCgpXHJcbiAgICAgIC50aGVuKGNvbnNvbGUubG9nKTtcclxuICAgIHJldHVybiByZWNlaXB0LnRyYW5zYWN0aW9uSGFzaDtcclxuICB9XHJcblxyXG4gIGdldERhdGEoKSB7XHJcbiAgICByZXR1cm4gc3RvcmFnZUNvbnRyYWN0Lm1ldGhvZHMucmV0cmlldmUoKS5jYWxsKCk7XHJcblxyXG5cclxuXHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRCbG9ja051bWJlcigpIHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gd2ViMy5ldGguZ2V0QmxvY2tOdW1iZXIoZnVuY3Rpb24gKGVycm9yLCByZXN1bHQpIHtcclxuICAgICAgY29uc29sZS5sb2cocmVzdWx0KVxyXG4gICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfSlcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgY3JlYXRlX2FjY291bnQoaWQpIHtcclxuICAgIGNvbnN0IG5ld19hY2NvdW50ID0gd2ViMy5ldGguYWNjb3VudHMuY3JlYXRlKCk7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ld19hY2NvdW50KTtcclxuICB9XHJcblxyXG4gIGJhbGFuY2UoYWRkcmVzcykge1xyXG4gICAgY29uc29sZS5sb2coYWRkcmVzcyk7XHJcbiAgICBjb25zdCBhZGQgPSB3ZWIzLmV0aC5nZXRCYWxhbmNlKGFkZHJlc3MpO1xyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhZGQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pIHtcclxuICAgIGNvbnN0IHR4ID0gd2ViMy5ldGguZ2V0VHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0eCk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG5ldyBCbG9ja2NoYWluU2VydmljaWVzKCk7XHJcbiJdfQ==